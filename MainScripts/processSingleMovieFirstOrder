function processSingleMovieFirstOrder(folderPath, ~)
    % processSingleMovieFirstOrder: Compute first-order transition matrices.
    % 
    % Inputs:
    % - folderPath: Path to folder containing data.
    % - ~: Placeholder for an unused input (k).

    % Call the function to extract the data
    [filesNames, numBehaviors, behaviorLabels, numFlies] = extractBehaviorData(folderPath);
    
    % Initialize a cell array to store combined scores matrices for each fly 
    % combinedScoresMatrices = cell(1, numFlies);

    % Initialize a cell array to store transition matrices for each fly
    transitionMatrices = cell(1, numFlies);

    % Loop through each fly to create and store combined scores matrices
    for flyNum = 1:numFlies
        % Generate the combined scores matrix for the current fly
        [combinedScoresMatrix, ~] = createCombinedScoresMatrix(filesNames, numBehaviors, flyNum);
        
        % Store the combined scores matrix in the cell array
        % combinedScoresMatrices{flyNum} = combinedScoresMatrix;
        
        % Generate the transition matrix for the current fly
        transitionMatrix = computeFirstOrderTransitionMatrix(combinedScoresMatrix);
        
        % Store the transition matrix for the current fly
        transitionMatrices{flyNum} = transitionMatrix;
    end

    % Calculate the average transition matrix for the movie
    averageMovieMatrix = zeros(numBehaviors, numBehaviors);
    for i = 1:numBehaviors
        for j = 1:numBehaviors
            % Average over all flies for element (i, j)
            for flyNum = 1:numFlies
                averageMovieMatrix(i, j) = averageMovieMatrix(i, j) + transitionMatrices{flyNum}(i, j);
            end
            % Divide by the number of flies
            averageMovieMatrix(i, j) = averageMovieMatrix(i, j) / numFlies;
        end
    end
    
    disp('First-order transition matrices computed for all flies.');

    outputDir = createUniqueOutputDir(folderPath, 'FirstOrderTransitionMatrices');

    % Save transition matrices to an Excel file in the created directory
    excelFileName = fullfile(outputDir, 'transitionMatrices.xlsx');
    saveFirstOrderTransitionMatricesToExcel(excelFileName, transitionMatrices, averageMovieMatrix, behaviorLabels, numFlies);

    generateAndSaveHeatmaps(outputDir, transitionMatrices, averageMovieMatrix, behaviorLabels, numFlies);
    disp(['All transition matrices and heatmaps saved in ', outputDir]);
end
